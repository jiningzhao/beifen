2020-05-20 10:46:35 [scrapy.utils.log] INFO: Scrapy 2.1.0 started (bot: mySpider)
2020-05-20 10:46:35 [scrapy.utils.log] INFO: Versions: lxml 4.5.0.0, libxml2 2.9.10, cssselect 1.1.0, parsel 1.5.2, w3lib 1.21.0, Twisted 20.3.0, Python 3.8.0 (v3.8.0:fa919fdf25, Oct 14 2019, 10:23:27) - [Clang 6.0 (clang-600.0.57)], pyOpenSSL 19.1.0 (OpenSSL 1.1.1f  31 Mar 2020), cryptography 2.9, Platform macOS-10.15.3-x86_64-i386-64bit
2020-05-20 10:46:35 [scrapy.utils.log] DEBUG: Using reactor: twisted.internet.selectreactor.SelectReactor
2020-05-20 10:46:35 [scrapy.crawler] INFO: Overridden settings:
{'BOT_NAME': 'mySpider',
 'CONCURRENT_REQUESTS_PER_IP': 1,
 'DOWNLOAD_DELAY': 0.25,
 'LOG_FILE': 'logs/mySpider/stock/1e1531a89a4411eaaed3acde48001122.log',
 'NEWSPIDER_MODULE': 'mySpider.spiders',
 'SPIDER_MODULES': ['mySpider.spiders']}
2020-05-20 10:46:35 [scrapy.extensions.telnet] INFO: Telnet Password: 087102d4500c4b70
2020-05-20 10:46:35 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.logstats.LogStats']
2020-05-20 10:46:35 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2020-05-20 10:46:35 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-05-20 10:46:35 [scrapy.middleware] INFO: Enabled item pipelines:
['mySpider.pipelines.MyspiderPipeline']
2020-05-20 10:46:35 [scrapy.core.engine] INFO: Spider opened
2020-05-20 10:46:35 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-05-20 10:46:35 [scrapy.extensions.telnet] INFO: Telnet console listening on 127.0.0.1:6023
2020-05-20 10:46:50 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_1.html> (referer: None)
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '26961221.25',
 'abbr': '工商银行',
 'code': '601398',
 'general_capital': '35640625.71',
 'total_value': '182123597.37',
 'traded_market_value': '137771840.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '125619.78',
 'abbr': '贵州茅台',
 'code': '600519',
 'general_capital': '125619.78',
 'total_value': '169172157.73',
 'traded_market_value': '169172157.73'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '959365.76',
 'abbr': '建设银行',
 'code': '601939',
 'general_capital': '25001097.75',
 'total_value': '159757014.61',
 'traded_market_value': '6130347.21'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1083266.45',
 'abbr': '中国平安',
 'code': '601318',
 'general_capital': '1828024.14',
 'total_value': '132751113.12',
 'traded_market_value': '78666809.58'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '29405529.39',
 'abbr': '农业银行',
 'code': '601288',
 'general_capital': '34998303.39',
 'total_value': '118994231.52',
 'traded_market_value': '99978799.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '21076551.48',
 'abbr': '中国银行',
 'code': '601988',
 'general_capital': '29438779.12',
 'total_value': '101563787.98',
 'traded_market_value': '72714102.62'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2062894.44',
 'abbr': '招商银行',
 'code': '600036',
 'general_capital': '2521984.56',
 'total_value': '86075333.04',
 'traded_market_value': '70406587.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '16192207.78',
 'abbr': '中国石油',
 'code': '601857',
 'general_capital': '18302097.78',
 'total_value': '81261314.15',
 'traded_market_value': '71893402.55'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2082353.00',
 'abbr': '中国人寿',
 'code': '601628',
 'general_capital': '2826470.50',
 'total_value': '76201644.68',
 'traded_market_value': '56140236.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '379575.80',
 'abbr': '五 粮 液',
 'code': '000858',
 'general_capital': '388160.80',
 'total_value': '58829650.92',
 'traded_market_value': '57528507.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '9555777.10',
 'abbr': '中国石化',
 'code': '600028',
 'general_capital': '12107120.96',
 'total_value': '53029189.82',
 'traded_market_value': '41854303.72'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '297399.23',
 'abbr': '邮储银行',
 'code': '601658',
 'general_capital': '8620273.82',
 'total_value': '43790991.01',
 'traded_market_value': '1510788.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '441311.49',
 'abbr': '恒瑞医药',
 'code': '600276',
 'general_capital': '442229.20',
 'total_value': '43639176.97',
 'traded_market_value': '43548618.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '682489.95',
 'abbr': '美的集团',
 'code': '000333',
 'general_capital': '698544.60',
 'total_value': '41207145.94',
 'traded_market_value': '40260082.10'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3925086.40',
 'abbr': '交通银行',
 'code': '601328',
 'general_capital': '7426272.66',
 'total_value': '38171041.50',
 'traded_market_value': '20174944.10'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2200000.00',
 'abbr': '长江电力',
 'code': '600900',
 'general_capital': '2200000.00',
 'total_value': '37444000.00',
 'traded_market_value': '37444000.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '324044.32',
 'abbr': '海天味业',
 'code': '603288',
 'general_capital': '324044.32',
 'total_value': '36934571.68',
 'traded_market_value': '36934571.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '596993.13',
 'abbr': '格力电器',
 'code': '000651',
 'general_capital': '601573.09',
 'total_value': '34524279.51',
 'traded_market_value': '34261435.46'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '120258.95',
 'abbr': '宁德时代',
 'code': '300750',
 'general_capital': '220839.97',
 'total_value': '33960770.59',
 'traded_market_value': '18493421.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1961525.06',
 'abbr': '兴业银行',
 'code': '601166',
 'general_capital': '2077419.08',
 'total_value': '33321801.96',
 'traded_market_value': '31462861.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '49913.43',
 'abbr': '迈瑞医疗',
 'code': '300760',
 'general_capital': '121569.13',
 'total_value': '32725193.19',
 'traded_market_value': '13436195.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1649103.80',
 'abbr': '中国神华',
 'code': '601088',
 'general_capital': '1988962.05',
 'total_value': '32579198.31',
 'traded_market_value': '27012320.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '399970.26',
 'abbr': '海螺水泥',
 'code': '600585',
 'general_capital': '529930.26',
 'total_value': '30985022.18',
 'traded_market_value': '23386260.98'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '260421.03',
 'abbr': '京沪高铁',
 'code': '601816',
 'general_capital': '4910648.46',
 'total_value': '30544233.43',
 'traded_market_value': '1619818.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2810376.39',
 'abbr': '浦发银行',
 'code': '600000',
 'general_capital': '2935208.04',
 'total_value': '30379403.21',
 'traded_market_value': '29087395.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '981466.17',
 'abbr': '中信证券',
 'code': '600030',
 'general_capital': '1292677.60',
 'total_value': '29899632.96',
 'traded_market_value': '22701312.51'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '971517.00',
 'abbr': '万 科Ａ',
 'code': '000002',
 'general_capital': '1130214.30',
 'total_value': '28944788.23',
 'traded_market_value': '24880550.48'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '809027.24',
 'abbr': '海康威视',
 'code': '002415',
 'general_capital': '934501.07',
 'total_value': '27997652.05',
 'traded_market_value': '24238455.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '560156.70',
 'abbr': '中国人保',
 'code': '601319',
 'general_capital': '4422399.06',
 'total_value': '27684218.10',
 'traded_market_value': '3506580.95'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '183881.40',
 'abbr': '工业富联',
 'code': '601138',
 'general_capital': '1985483.19',
 'total_value': '27518797.01',
 'traded_market_value': '2548596.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_2.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_1.html)
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '86437.52',
 'abbr': '中信建投',
 'code': '601066',
 'general_capital': '764638.52',
 'total_value': '26303565.22',
 'traded_market_value': '2973450.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '628670.00',
 'abbr': '中国太保',
 'code': '601601',
 'general_capital': '906200.00',
 'total_value': '26279800.00',
 'traded_market_value': '18231430.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1940575.27',
 'abbr': '平安银行',
 'code': '000001',
 'general_capital': '1940591.82',
 'total_value': '25868088.96',
 'traded_market_value': '25867868.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3546212.32',
 'abbr': '民生银行',
 'code': '600016',
 'general_capital': '4378241.85',
 'total_value': '25350020.31',
 'traded_market_value': '20532569.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '139091.72',
 'abbr': '牧原股份',
 'code': '002714',
 'general_capital': '220460.83',
 'total_value': '24991439.94',
 'traded_market_value': '15767436.91'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '536391.65',
 'abbr': '立讯精密',
 'code': '002475',
 'general_capital': '536511.56',
 'total_value': '24899501.47',
 'traded_market_value': '24893936.65'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3190518.52',
 'abbr': '中信银行',
 'code': '601998',
 'general_capital': '4893481.77',
 'total_value': '24858887.42',
 'traded_market_value': '16207834.10'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1168346.14',
 'abbr': '上汽集团',
 'code': '600104',
 'general_capital': '1168346.14',
 'total_value': '21591036.60',
 'traded_market_value': '21591036.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4125360.28',
 'abbr': '中国建筑',
 'code': '601668',
 'general_capital': '4196507.15',
 'total_value': '21360221.40',
 'traded_market_value': '20998083.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '434569.42',
 'abbr': '顺丰控股',
 'code': '002352',
 'general_capital': '441431.09',
 'total_value': '20394116.45',
 'traded_market_value': '20077107.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3981059.64',
 'abbr': '光大银行',
 'code': '601818',
 'general_capital': '5248933.19',
 'total_value': '19368563.47',
 'traded_market_value': '14690110.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '347203.40',
 'abbr': '中兴通讯',
 'code': '000063',
 'general_capital': '460912.90',
 'total_value': '18528698.56',
 'traded_market_value': '13957576.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '100938.55',
 'abbr': '药明康德',
 'code': '603259',
 'general_capital': '165112.65',
 'total_value': '18195414.37',
 'traded_market_value': '11123427.69'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1193267.52',
 'abbr': '保利地产',
 'code': '600048',
 'general_capital': '1193267.52',
 'total_value': '18173464.27',
 'traded_market_value': '18173464.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '588213.96',
 'abbr': '伊利股份',
 'code': '600887',
 'general_capital': '606588.68',
 'total_value': '17518281.17',
 'traded_market_value': '16987619.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '82033.60',
 'abbr': '中公教育',
 'code': '002607',
 'general_capital': '616739.94',
 'total_value': '17496912.07',
 'traded_market_value': '2327293.12'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '195247.55',
 'abbr': '中国国旅',
 'code': '601888',
 'general_capital': '195247.55',
 'total_value': '17460988.79',
 'traded_market_value': '17460988.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2432779.80',
 'abbr': '中国中车',
 'code': '601766',
 'general_capital': '2869886.41',
 'total_value': '17362812.77',
 'traded_market_value': '14718317.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '15637.90',
 'abbr': '韦尔股份',
 'code': '603501',
 'general_capital': '86357.66',
 'total_value': '16821608.55',
 'traded_market_value': '3046105.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '843040.04',
 'abbr': '三一重工',
 'code': '600031',
 'general_capital': '843553.30',
 'total_value': '16592693.41',
 'traded_market_value': '16582597.67'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '114162.60',
 'abbr': '比亚迪',
 'code': '002594',
 'general_capital': '272814.29',
 'total_value': '16262459.56',
 'traded_market_value': '6805232.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '735760.43',
 'abbr': '华泰证券',
 'code': '601688',
 'general_capital': '907665.00',
 'total_value': '16020287.25',
 'traded_market_value': '12986171.62'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2149991.08',
 'abbr': '中国联通',
 'code': '600050',
 'general_capital': '3102550.77',
 'total_value': '15885059.94',
 'traded_market_value': '11007954.33'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '124893.96',
 'abbr': '洋河股份',
 'code': '002304',
 'general_capital': '150698.80',
 'total_value': '15521976.40',
 'traded_market_value': '12864077.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '142375.64',
 'abbr': '万华化学',
 'code': '600309',
 'general_capital': '313974.66',
 'total_value': '14973451.66',
 'traded_market_value': '6789894.37'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '251549.07',
 'abbr': '爱尔眼科',
 'code': '300015',
 'general_capital': '309781.12',
 'total_value': '14968623.85',
 'traded_market_value': '12154850.92'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '402093.89',
 'abbr': '温氏股份',
 'code': '300498',
 'general_capital': '531150.95',
 'total_value': '14962522.39',
 'traded_market_value': '11326985.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '252493.11',
 'abbr': '中国广核',
 'code': '003816',
 'general_capital': '5049861.11',
 'total_value': '14392104.16',
 'traded_market_value': '719605.36'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '751612.13',
 'abbr': '国泰君安',
 'code': '601211',
 'general_capital': '890794.85',
 'total_value': '14368520.96',
 'traded_market_value': '12123503.72'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:46:58 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:46:58 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '809213.12',
 'abbr': '海通证券',
 'code': '600837',
 'general_capital': '1150170.00',
 'total_value': '14285111.40',
 'traded_market_value': '10050426.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:03 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_3.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_2.html)
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '208543.93',
 'abbr': '新华保险',
 'code': '601336',
 'general_capital': '311954.66',
 'total_value': '14069155.17',
 'traded_market_value': '9405331.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '562157.28',
 'abbr': '宁波银行',
 'code': '002142',
 'general_capital': '562832.95',
 'total_value': '14020168.85',
 'traded_market_value': '14003337.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3386056.05',
 'abbr': '京东方Ａ',
 'code': '000725',
 'general_capital': '3479839.88',
 'total_value': '13710569.11',
 'traded_market_value': '13341060.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '88201.74',
 'abbr': '双汇发展',
 'code': '000895',
 'general_capital': '331928.22',
 'total_value': '13595779.85',
 'traded_market_value': '3612743.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1863691.15',
 'abbr': '中国中铁',
 'code': '601390',
 'general_capital': '2457092.93',
 'total_value': '13563152.96',
 'traded_market_value': '10287575.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '16999.20',
 'abbr': '长春高新',
 'code': '000661',
 'general_capital': '20236.01',
 'total_value': '13374791.42',
 'traded_market_value': '11235452.57'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '109347.64',
 'abbr': '上海机场',
 'code': '600009',
 'general_capital': '192695.84',
 'total_value': '13296013.29',
 'traded_market_value': '7544987.14'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '87576.90',
 'abbr': '智飞生物',
 'code': '300122',
 'general_capital': '160000.00',
 'total_value': '13211200.00',
 'traded_market_value': '7231224.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '6664.22',
 'abbr': '金山办公',
 'code': '688111',
 'general_capital': '46100.00',
 'total_value': '13197508.00',
 'traded_market_value': '1907832.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1174723.54',
 'abbr': '中国交建',
 'code': '601800',
 'general_capital': '1617473.54',
 'total_value': '13004487.28',
 'traded_market_value': '9444777.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '146010.53',
 'abbr': '泸州老窖',
 'code': '000568',
 'general_capital': '146475.25',
 'total_value': '12941088.13',
 'traded_market_value': '12900030.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4842.66',
 'abbr': '中微公司',
 'code': '688012',
 'general_capital': '53486.22',
 'total_value': '12935107.44',
 'traded_market_value': '1171148.89'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '791577.18',
 'abbr': '招商蛇口',
 'code': '001979',
 'general_capital': '791620.81',
 'total_value': '12935084.00',
 'traded_market_value': '12934371.13'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1150324.55',
 'abbr': '中国铁建',
 'code': '601186',
 'general_capital': '1357954.15',
 'total_value': '12791928.09',
 'traded_market_value': '10836057.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '178923.18',
 'abbr': '三六零',
 'code': '601360',
 'general_capital': '676405.52',
 'total_value': '12581142.61',
 'traded_market_value': '3327971.10'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '63726.64',
 'abbr': '闻泰科技',
 'code': '600745',
 'general_capital': '112403.37',
 'total_value': '12529603.75',
 'traded_market_value': '7103608.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '376754.98',
 'abbr': '隆基股份',
 'code': '601012',
 'general_capital': '377201.68',
 'total_value': '12232650.34',
 'traded_market_value': '12218163.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '544607.91',
 'abbr': '东方财富',
 'code': '300059',
 'general_capital': '671560.87',
 'total_value': '12155251.67',
 'traded_market_value': '9857403.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '421173.38',
 'abbr': '新 希 望',
 'code': '000876',
 'general_capital': '421601.50',
 'total_value': '12142123.23',
 'traded_market_value': '12129793.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '219649.65',
 'abbr': '山东黄金',
 'code': '600547',
 'general_capital': '309961.16',
 'total_value': '11964500.90',
 'traded_market_value': '8478476.38'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '7438.48',
 'abbr': '澜起科技',
 'code': '688008',
 'general_capital': '112981.39',
 'total_value': '11678886.28',
 'traded_market_value': '768915.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '571900.81',
 'abbr': '招商证券',
 'code': '600999',
 'general_capital': '669940.93',
 'total_value': '11576579.32',
 'traded_market_value': '9882446.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1326178.23',
 'abbr': '上海银行',
 'code': '601229',
 'general_capital': '1420652.87',
 'total_value': '11336809.90',
 'traded_market_value': '10582902.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2253441.42',
 'abbr': '申万宏源',
 'code': '000166',
 'general_capital': '2503994.46',
 'total_value': '11192855.22',
 'traded_market_value': '10072883.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60215.12',
 'abbr': '云南白药',
 'code': '000538',
 'general_capital': '127740.33',
 'total_value': '11045706.48',
 'traded_market_value': '5206801.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '424500.16',
 'abbr': '潍柴动力',
 'code': '000338',
 'general_capital': '793387.39',
 'total_value': '11012216.97',
 'traded_market_value': '5892062.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '407842.49',
 'abbr': '三安光电',
 'code': '600703',
 'general_capital': '407842.49',
 'total_value': '10889394.56',
 'traded_market_value': '10889394.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2215598.26',
 'abbr': '宝钢股份',
 'code': '600019',
 'general_capital': '2227128.81',
 'total_value': '10757032.16',
 'traded_market_value': '10701339.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '44884.76',
 'abbr': '汇顶科技',
 'code': '603160',
 'general_capital': '45605.44',
 'total_value': '10744642.56',
 'traded_market_value': '10574848.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:04 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:04 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '86584.83',
 'abbr': '山西汾酒',
 'code': '600809',
 'general_capital': '87152.83',
 'total_value': '10501915.61',
 'traded_market_value': '10433471.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_4.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_3.html)
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1922176.69',
 'abbr': '紫金矿业',
 'code': '601899',
 'general_capital': '2537725.99',
 'total_value': '10430053.84',
 'traded_market_value': '7900146.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '591929.15',
 'abbr': '广发证券',
 'code': '000776',
 'general_capital': '762108.77',
 'total_value': '10395163.57',
 'traded_market_value': '8073913.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '6000.00',
 'abbr': '公牛集团',
 'code': '603195',
 'general_capital': '60000.00',
 'total_value': '10369800.00',
 'traded_market_value': '1036980.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1824801.08',
 'abbr': '北京银行',
 'code': '601169',
 'general_capital': '2114298.43',
 'total_value': '10338919.31',
 'traded_market_value': '8923277.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1486679.15',
 'abbr': '大秦铁路',
 'code': '601006',
 'general_capital': '1486679.15',
 'total_value': '10183752.17',
 'traded_market_value': '10183752.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '644627.41',
 'abbr': '中国银河',
 'code': '601881',
 'general_capital': '1013725.88',
 'total_value': '10127121.50',
 'traded_market_value': '6439827.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '630855.27',
 'abbr': '海尔智家',
 'code': '600690',
 'general_capital': '657956.66',
 'total_value': '10046998.24',
 'traded_market_value': '9633159.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '608434.09',
 'abbr': '广汽集团',
 'code': '601238',
 'general_capital': '1023770.76',
 'total_value': '9992002.63',
 'traded_market_value': '5938316.77'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '39646.77',
 'abbr': '兆易创新',
 'code': '603986',
 'general_capital': '44944.73',
 'total_value': '9983122.65',
 'traded_market_value': '8806339.73'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1282268.67',
 'abbr': '华夏银行',
 'code': '600015',
 'general_capital': '1538722.40',
 'total_value': '9878597.80',
 'traded_market_value': '8232164.83'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '996213.18',
 'abbr': '中国国航',
 'code': '601111',
 'general_capital': '1452481.52',
 'total_value': '9673526.91',
 'traded_market_value': '6634779.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '249318.70',
 'abbr': '用友网络',
 'code': '600588',
 'general_capital': '250328.11',
 'total_value': '9534997.82',
 'traded_market_value': '9496549.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '36303.03',
 'abbr': '康泰生物',
 'code': '300601',
 'general_capital': '64522.09',
 'total_value': '9533138.95',
 'traded_market_value': '5363772.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1828390.71',
 'abbr': '中国重工',
 'code': '601989',
 'general_capital': '2280203.53',
 'total_value': '9508448.73',
 'traded_market_value': '7624389.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '463193.56',
 'abbr': '恒力石化',
 'code': '600346',
 'general_capital': '703909.98',
 'total_value': '9439432.81',
 'traded_market_value': '6211425.65'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '26815.92',
 'abbr': '鹏鼎控股',
 'code': '002938',
 'general_capital': '231143.08',
 'total_value': '9430637.73',
 'traded_market_value': '1094089.37'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2317367.46',
 'abbr': '上港集团',
 'code': '600018',
 'general_capital': '2317367.46',
 'total_value': '9385338.23',
 'traded_market_value': '9385338.23'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '83402.02',
 'abbr': '芒果超媒',
 'code': '300413',
 'general_capital': '178037.75',
 'total_value': '9026513.98',
 'traded_market_value': '4228482.66'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '946825.14',
 'abbr': '永辉超市',
 'code': '601933',
 'general_capital': '957046.21',
 'total_value': '9024945.77',
 'traded_market_value': '8928561.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '293489.89',
 'abbr': '国电南瑞',
 'code': '600406',
 'general_capital': '462194.08',
 'total_value': '8994296.83',
 'traded_market_value': '5711313.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '204517.10',
 'abbr': '中油资本',
 'code': '000617',
 'general_capital': '903005.65',
 'total_value': '8957816.03',
 'traded_market_value': '2028809.65'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60331.72',
 'abbr': '片仔癀',
 'code': '600436',
 'general_capital': '60331.72',
 'total_value': '8890482.41',
 'traded_market_value': '8890482.41'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '45791.96',
 'abbr': '北方华创',
 'code': '002371',
 'general_capital': '49511.68',
 'total_value': '8862590.24',
 'traded_market_value': '8196761.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '820000.00',
 'abbr': '国信证券',
 'code': '002736',
 'general_capital': '820000.00',
 'total_value': '8847800.00',
 'traded_market_value': '8847800.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '80314.67',
 'abbr': '恒生电子',
 'code': '600570',
 'general_capital': '80314.67',
 'total_value': '8785622.12',
 'traded_market_value': '8785622.12'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '204291.42',
 'abbr': '紫光股份',
 'code': '000938',
 'general_capital': '204291.42',
 'total_value': '8682385.33',
 'traded_market_value': '8682385.33'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '206756.73',
 'abbr': '浙商银行',
 'code': '601916',
 'general_capital': '2126869.68',
 'total_value': '8635090.89',
 'traded_market_value': '839432.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '259239.41',
 'abbr': '世纪华通',
 'code': '002602',
 'general_capital': '622670.32',
 'total_value': '8574170.25',
 'traded_market_value': '3569726.65'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '201095.80',
 'abbr': '复星医药',
 'code': '600196',
 'general_capital': '256289.85',
 'total_value': '8357612.16',
 'traded_market_value': '6557734.18'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '13885.78',
 'abbr': '深南电路',
 'code': '002916',
 'general_capital': '47510.40',
 'total_value': '8171788.80',
 'traded_market_value': '2388354.99'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_5.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_4.html)
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '777518.93',
 'abbr': '苏宁易购',
 'code': '002024',
 'general_capital': '931003.97',
 'total_value': '8127664.62',
 'traded_market_value': '6787740.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '13885.78',
 'abbr': '深南电路',
 'code': '002916',
 'general_capital': '47510.40',
 'total_value': '8116676.74',
 'traded_market_value': '2372247.48'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '21030.34',
 'abbr': '深信服',
 'code': '300454',
 'general_capital': '40892.71',
 'total_value': '8093485.95',
 'traded_market_value': '4162325.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '137811.76',
 'abbr': '中国船舶',
 'code': '600150',
 'general_capital': '422198.83',
 'total_value': '7971113.99',
 'traded_market_value': '2601886.02'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '38360.00',
 'abbr': '古井贡酒',
 'code': '000596',
 'general_capital': '50360.00',
 'total_value': '7831483.60',
 'traded_market_value': '5965363.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '36400.00',
 'abbr': '红塔证券',
 'code': '601236',
 'general_capital': '363340.54',
 'total_value': '7822721.82',
 'traded_market_value': '783692.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1766577.26',
 'abbr': '洛阳钼业',
 'code': '603993',
 'general_capital': '2159924.06',
 'total_value': '7710928.89',
 'traded_market_value': '6306680.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '76399.44',
 'abbr': '中信特钢',
 'code': '000708',
 'general_capital': '504714.34',
 'total_value': '7686799.45',
 'traded_market_value': '1163563.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '131749.62',
 'abbr': '三七互娱',
 'code': '002555',
 'general_capital': '211225.17',
 'total_value': '7673810.42',
 'traded_market_value': '4786463.80'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '848220.79',
 'abbr': '南京银行',
 'code': '601009',
 'general_capital': '1000701.70',
 'total_value': '7635353.95',
 'traded_market_value': '6471924.65'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '156521.60',
 'abbr': '海大集团',
 'code': '002311',
 'general_capital': '158035.75',
 'total_value': '7623644.55',
 'traded_market_value': '7550601.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '436916.75',
 'abbr': '蓝思科技',
 'code': '300433',
 'general_capital': '438385.74',
 'total_value': '7619144.09',
 'traded_market_value': '7593613.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '186721.80',
 'abbr': '科大讯飞',
 'code': '002230',
 'general_capital': '219857.51',
 'total_value': '7600474.01',
 'traded_market_value': '6454972.66'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '602772.90',
 'abbr': '长城汽车',
 'code': '601633',
 'general_capital': '912726.90',
 'total_value': '7502615.12',
 'traded_market_value': '4954793.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '156697.34',
 'abbr': '华兰生物',
 'code': '002007',
 'general_capital': '182436.67',
 'total_value': '7390509.61',
 'traded_market_value': '6347809.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1000000.00',
 'abbr': '陕西煤业',
 'code': '601225',
 'general_capital': '1000000.00',
 'total_value': '7350000.00',
 'traded_market_value': '7350000.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1467788.03',
 'abbr': '分众传媒',
 'code': '002027',
 'general_capital': '1467788.03',
 'total_value': '7324262.26',
 'traded_market_value': '7324262.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '581623.45',
 'abbr': '荣盛石化',
 'code': '002493',
 'general_capital': '629110.78',
 'total_value': '7322849.42',
 'traded_market_value': '6770096.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '214990.47',
 'abbr': '韵达股份',
 'code': '002120',
 'general_capital': '222628.65',
 'total_value': '7308898.47',
 'traded_market_value': '7058137.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '40000.00',
 'abbr': '中国卫通',
 'code': '601698',
 'general_capital': '400000.00',
 'total_value': '7192000.00',
 'traded_market_value': '719200.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '151524.97',
 'abbr': '乐普医疗',
 'code': '300003',
 'general_capital': '178165.29',
 'total_value': '7172934.66',
 'traded_market_value': '6100395.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1266067.37',
 'abbr': 'TCL科技',
 'code': '000100',
 'general_capital': '1352843.87',
 'total_value': '7075373.45',
 'traded_market_value': '6621532.37'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '224635.52',
 'abbr': '新城控股',
 'code': '601155',
 'general_capital': '225672.42',
 'total_value': '7065803.43',
 'traded_market_value': '7033338.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1089066.19',
 'abbr': '上海电气',
 'code': '601727',
 'general_capital': '1515246.24',
 'total_value': '7000437.64',
 'traded_market_value': '5031485.80'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1140578.28',
 'abbr': '江苏银行',
 'code': '600919',
 'general_capital': '1154450.55',
 'total_value': '6834347.27',
 'traded_market_value': '6752223.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '80131.87',
 'abbr': '赣锋锂业',
 'code': '002460',
 'general_capital': '129282.21',
 'total_value': '6818343.54',
 'traded_market_value': '4226154.87'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '980848.57',
 'abbr': '东方航空',
 'code': '600115',
 'general_capital': '1637950.92',
 'total_value': '6813875.83',
 'traded_market_value': '4080330.04'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1099770.99',
 'abbr': '华能国际',
 'code': '600011',
 'general_capital': '1569809.34',
 'total_value': '6812972.52',
 'traded_market_value': '4773006.10'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '297922.29',
 'abbr': '华夏幸福',
 'code': '600340',
 'general_capital': '301328.59',
 'total_value': '6770853.44',
 'traded_market_value': '6694313.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:29 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:47:29 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '227619.13',
 'abbr': '生益科技',
 'code': '600183',
 'general_capital': '227619.13',
 'total_value': '6746631.13',
 'traded_market_value': '6746631.13'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:47:35 [scrapy.extensions.logstats] INFO: Crawled 5 pages (at 5 pages/min), scraped 0 items (at 0 items/min)
2020-05-20 10:48:11 [scrapy.downloadermiddlewares.retry] DEBUG: Retrying <GET http://quote.stockstar.com/stock/ranklist_a_3_1_6.html> (failed 1 times): [<twisted.python.failure.Failure twisted.internet.error.ConnectionLost: Connection to the other side was lost in a non-clean fashion.>]
2020-05-20 10:48:22 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_6.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_5.html)
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '272089.75',
 'abbr': '歌尔股份',
 'code': '002241',
 'general_capital': '324510.39',
 'total_value': '6714120.07',
 'traded_market_value': '5629536.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '315317.16',
 'abbr': '中国通号',
 'code': '688009',
 'general_capital': '1058981.90',
 'total_value': '6703355.43',
 'traded_market_value': '1995957.62'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1216815.44',
 'abbr': '绿地控股',
 'code': '600606',
 'general_capital': '1216815.44',
 'total_value': '6619475.99',
 'traded_market_value': '6619475.99'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '240663.61',
 'abbr': '三花智控',
 'code': '002050',
 'general_capital': '276536.67',
 'total_value': '6614757.14',
 'traded_market_value': '5756673.58'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1556545.05',
 'abbr': '中国核电',
 'code': '601985',
 'general_capital': '1556545.05',
 'total_value': '6599750.99',
 'traded_market_value': '6599750.99'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '172415.42',
 'abbr': '领益智造',
 'code': '002600',
 'general_capital': '682707.74',
 'total_value': '6560821.42',
 'traded_market_value': '1656912.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '73336.00',
 'abbr': '宝丰能源',
 'code': '600989',
 'general_capital': '733336.00',
 'total_value': '6541357.12',
 'traded_market_value': '654157.12'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '567736.05',
 'abbr': '东方证券',
 'code': '600958',
 'general_capital': '699365.58',
 'total_value': '6532074.52',
 'traded_market_value': '5302654.74'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '81913.38',
 'abbr': '亿纬锂能',
 'code': '300014',
 'general_capital': '96913.97',
 'total_value': '6510680.47',
 'traded_market_value': '5502941.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '315272.40',
 'abbr': '华域汽车',
 'code': '600741',
 'general_capital': '315272.40',
 'total_value': '6485153.24',
 'traded_market_value': '6485153.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '145449.57',
 'abbr': '沃森生物',
 'code': '300142',
 'general_capital': '153743.70',
 'total_value': '6466459.95',
 'traded_market_value': '6117608.71'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '892800.00',
 'abbr': '华能水电',
 'code': '600025',
 'general_capital': '1800000.00',
 'total_value': '6426000.00',
 'traded_market_value': '3187296.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '27800.00',
 'abbr': '中银证券',
 'code': '601696',
 'general_capital': '277800.00',
 'total_value': '6414402.00',
 'traded_market_value': '641902.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '88200.00',
 'abbr': '恒立液压',
 'code': '601100',
 'general_capital': '88200.00',
 'total_value': '6413022.00',
 'traded_market_value': '6413022.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '83636.98',
 'abbr': '宝信软件',
 'code': '600845',
 'general_capital': '114037.03',
 'total_value': '6407740.45',
 'traded_market_value': '4699561.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '296046.80',
 'abbr': '中海油服',
 'code': '601808',
 'general_capital': '477159.20',
 'total_value': '6360532.14',
 'traded_market_value': '3946303.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '428785.57',
 'abbr': '通威股份',
 'code': '600438',
 'general_capital': '428785.57',
 'total_value': '6333162.85',
 'traded_market_value': '6333162.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '144111.80',
 'abbr': '浪潮信息',
 'code': '000977',
 'general_capital': '144111.91',
 'total_value': '6320748.28',
 'traded_market_value': '6320743.73'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '54348.71',
 'abbr': '泰格医药',
 'code': '300347',
 'general_capital': '74950.76',
 'total_value': '6280873.68',
 'traded_market_value': '4554421.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '811152.04',
 'abbr': '南方航空',
 'code': '600029',
 'general_capital': '1226717.23',
 'total_value': '6280792.21',
 'traded_market_value': '4153098.46'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '89176.20',
 'abbr': '广联达',
 'code': '002410',
 'general_capital': '112852.87',
 'total_value': '6267848.61',
 'traded_market_value': '4952846.33'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '26888.76',
 'abbr': '同花顺',
 'code': '300033',
 'general_capital': '53760.00',
 'total_value': '6252288.00',
 'traded_market_value': '3127163.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '138144.05',
 'abbr': '汇川技术',
 'code': '300124',
 'general_capital': '173169.43',
 'total_value': '6140587.83',
 'traded_market_value': '4898587.91'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2500.00',
 'abbr': '卓胜微',
 'code': '300782',
 'general_capital': '10000.00',
 'total_value': '6139900.00',
 'traded_market_value': '1534975.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '43060.29',
 'abbr': '安图生物',
 'code': '603658',
 'general_capital': '43060.29',
 'total_value': '6096475.84',
 'traded_market_value': '6096475.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '110143.20',
 'abbr': '东方雨虹',
 'code': '002271',
 'general_capital': '156978.47',
 'total_value': '6045240.87',
 'traded_market_value': '4241614.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '823210.14',
 'abbr': '方正证券',
 'code': '601901',
 'general_capital': '823210.14',
 'total_value': '5828327.79',
 'traded_market_value': '5828327.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '116041.89',
 'abbr': '完美世界',
 'code': '002624',
 'general_capital': '129316.89',
 'total_value': '5812794.02',
 'traded_market_value': '5216083.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '497238.84',
 'abbr': '上海莱士',
 'code': '002252',
 'general_capital': '674078.79',
 'total_value': '5810559.18',
 'traded_market_value': '4286198.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:22 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:22 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '61074.22',
 'abbr': '苏 泊 尔',
 'code': '002032',
 'general_capital': '82111.99',
 'total_value': '5797927.68',
 'traded_market_value': '4312450.98'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:35 [scrapy.extensions.logstats] INFO: Crawled 6 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2020-05-20 10:48:43 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_7.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_6.html)
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '194772.66',
 'abbr': '航发动力',
 'code': '600893',
 'general_capital': '224984.44',
 'total_value': '5759601.79',
 'traded_market_value': '4986179.97'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '451458.36',
 'abbr': '金地集团',
 'code': '600383',
 'general_capital': '451458.36',
 'total_value': '5756094.05',
 'traded_market_value': '5756094.05'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '136187.99',
 'abbr': '华新水泥',
 'code': '600801',
 'general_capital': '209659.99',
 'total_value': '5746780.20',
 'traded_market_value': '3732912.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '212148.14',
 'abbr': '新 和 成',
 'code': '002001',
 'general_capital': '214866.23',
 'total_value': '5603711.28',
 'traded_market_value': '5532823.39'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '135700.00',
 'abbr': '渝农商行',
 'code': '601077',
 'general_capital': '1135700.00',
 'total_value': '5553573.00',
 'traded_market_value': '663573.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '214997.36',
 'abbr': '正泰电器',
 'code': '601877',
 'general_capital': '214997.36',
 'total_value': '5525432.03',
 'traded_market_value': '5525432.03'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '268326.09',
 'abbr': '中环股份',
 'code': '002129',
 'general_capital': '278515.65',
 'total_value': '5520180.13',
 'traded_market_value': '5318223.01'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1114440.15',
 'abbr': '中国电建',
 'code': '601669',
 'general_capital': '1529903.50',
 'total_value': '5492353.57',
 'traded_market_value': '4000840.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '31835.39',
 'abbr': '亿联网络',
 'code': '300628',
 'general_capital': '59939.20',
 'total_value': '5425096.99',
 'traded_market_value': '2881421.38'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '641738.39',
 'abbr': '中联重科',
 'code': '000157',
 'general_capital': '787327.46',
 'total_value': '5424686.23',
 'traded_market_value': '4421577.53'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '28323.33',
 'abbr': '康龙化成',
 'code': '300759',
 'general_capital': '79438.75',
 'total_value': '5386741.38',
 'traded_market_value': '1920605.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4566.56',
 'abbr': '华熙生物',
 'code': '688363',
 'general_capital': '48000.00',
 'total_value': '5383200.00',
 'traded_market_value': '512139.70'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1785261.92',
 'abbr': '中国中冶',
 'code': '601618',
 'general_capital': '2072361.92',
 'total_value': '5346693.75',
 'traded_market_value': '4605975.75'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '130205.09',
 'abbr': '中科曙光',
 'code': '603019',
 'general_capital': '130205.09',
 'total_value': '5291534.87',
 'traded_market_value': '5291534.87'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '36596.34',
 'abbr': '视源股份',
 'code': '002841',
 'general_capital': '65566.21',
 'total_value': '5251853.09',
 'traded_market_value': '2931366.75'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '379976.68',
 'abbr': '宁沪高速',
 'code': '600377',
 'general_capital': '503774.75',
 'total_value': '5224144.16',
 'traded_market_value': '3940358.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '98457.00',
 'abbr': '长电科技',
 'code': '600584',
 'general_capital': '160287.46',
 'total_value': '5207739.43',
 'traded_market_value': '3198867.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '417383.19',
 'abbr': '国投资本',
 'code': '600061',
 'general_capital': '422712.97',
 'total_value': '5182461.05',
 'traded_market_value': '5117117.94'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '468618.31',
 'abbr': '杭州银行',
 'code': '600926',
 'general_capital': '593020.04',
 'total_value': '5147413.97',
 'traded_market_value': '4067606.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '192293.50',
 'abbr': '上海医药',
 'code': '601607',
 'general_capital': '284208.93',
 'total_value': '5118602.87',
 'traded_market_value': '3463205.97'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '390669.88',
 'abbr': '光大证券',
 'code': '601788',
 'general_capital': '461078.76',
 'total_value': '5113363.49',
 'traded_market_value': '4332529.01'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '678602.33',
 'abbr': '国投电力',
 'code': '600886',
 'general_capital': '678602.33',
 'total_value': '5103089.56',
 'traded_market_value': '5103089.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '200298.63',
 'abbr': '福耀玻璃',
 'code': '600660',
 'general_capital': '250861.75',
 'total_value': '5092493.59',
 'traded_market_value': '4066062.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '140589.09',
 'abbr': '白云山',
 'code': '600332',
 'general_capital': '162579.09',
 'total_value': '5059461.43',
 'traded_market_value': '4375132.63'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '915200.04',
 'abbr': '中煤能源',
 'code': '601898',
 'general_capital': '1325866.34',
 'total_value': '5038292.09',
 'traded_market_value': '3477760.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3167721.16',
 'abbr': '包钢股份',
 'code': '600010',
 'general_capital': '4558503.26',
 'total_value': '5014353.59',
 'traded_market_value': '3484493.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '276862.74',
 'abbr': '中航飞机',
 'code': '000768',
 'general_capital': '276864.51',
 'total_value': '5000173.00',
 'traded_market_value': '5000141.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '703620.99',
 'abbr': '华侨城Ａ',
 'code': '000069',
 'general_capital': '820250.64',
 'total_value': '4987123.90',
 'traded_market_value': '4278015.62'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '187108.95',
 'abbr': '大华股份',
 'code': '002236',
 'general_capital': '300327.61',
 'total_value': '4973425.27',
 'traded_market_value': '3098524.22'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:43 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:43 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '390064.35',
 'abbr': '长安汽车',
 'code': '000625',
 'general_capital': '480264.85',
 'total_value': '4956333.26',
 'traded_market_value': '4025464.06'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_8.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_7.html)
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '39852.21',
 'abbr': '中航沈飞',
 'code': '600760',
 'general_capital': '140038.93',
 'total_value': '4936372.23',
 'traded_market_value': '1404790.38'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '343230.02',
 'abbr': '美年健康',
 'code': '002044',
 'general_capital': '391992.10',
 'total_value': '4911660.98',
 'traded_market_value': '4300672.14'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '76451.63',
 'abbr': '一汽解放',
 'code': '000800',
 'general_capital': '460966.62',
 'total_value': '4909294.52',
 'traded_market_value': '814209.87'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '699503.74',
 'abbr': '徐工机械',
 'code': '000425',
 'general_capital': '783366.84',
 'total_value': '4833373.42',
 'traded_market_value': '4315938.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '92000.00',
 'abbr': '晨光文具',
 'code': '603899',
 'general_capital': '92000.00',
 'total_value': '4825400.00',
 'traded_market_value': '4825400.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '542893.77',
 'abbr': '*ST盐湖',
 'code': '000792',
 'general_capital': '543287.67',
 'total_value': '4802662.98',
 'traded_market_value': '4799180.94'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '206098.84',
 'abbr': '南京证券',
 'code': '601990',
 'general_capital': '329882.34',
 'total_value': '4799788.05',
 'traded_market_value': '2998738.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '25109.22',
 'abbr': '居然之家',
 'code': '000785',
 'general_capital': '601983.01',
 'total_value': '4785764.93',
 'traded_market_value': '199618.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1307870.70',
 'abbr': '中国铝业',
 'code': '601600',
 'general_capital': '1702267.30',
 'total_value': '4766348.43',
 'traded_market_value': '3662037.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '52112.08',
 'abbr': '恩捷股份',
 'code': '002812',
 'general_capital': '80537.08',
 'total_value': '4742828.46',
 'traded_market_value': '3068880.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '23023.59',
 'abbr': '凯莱英',
 'code': '002821',
 'general_capital': '23138.22',
 'total_value': '4726212.04',
 'traded_market_value': '4702799.47'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1360069.00',
 'abbr': '浙能电力',
 'code': '600023',
 'general_capital': '1360069.00',
 'total_value': '4705838.74',
 'traded_market_value': '4705838.74'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60623.24',
 'abbr': '紫光国微',
 'code': '002049',
 'general_capital': '60681.80',
 'total_value': '4685848.35',
 'traded_market_value': '4681326.55'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '125450.00',
 'abbr': '今世缘',
 'code': '603369',
 'general_capital': '125450.00',
 'total_value': '4660467.50',
 'traded_market_value': '4660467.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '42017.14',
 'abbr': '欧派家居',
 'code': '603833',
 'general_capital': '42017.14',
 'total_value': '4658020.18',
 'traded_market_value': '4658020.18'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '37083.25',
 'abbr': '健友股份',
 'code': '603707',
 'general_capital': '71847.42',
 'total_value': '4571651.33',
 'traded_market_value': '2359607.20'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '39871.67',
 'abbr': '中际旭创',
 'code': '300308',
 'general_capital': '71316.51',
 'total_value': '4549280.40',
 'traded_market_value': '2543414.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '118868.97',
 'abbr': '宋城演艺',
 'code': '300144',
 'general_capital': '145260.78',
 'total_value': '4520515.47',
 'traded_market_value': '3699202.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '293346.14',
 'abbr': 'XD陆家嘴',
 'code': '600663',
 'general_capital': '403419.74',
 'total_value': '4490061.75',
 'traded_market_value': '3264942.58'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '207524.74',
 'abbr': '江西铜业',
 'code': '600362',
 'general_capital': '346272.94',
 'total_value': '4470383.66',
 'traded_market_value': '2679144.40'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1317284.78',
 'abbr': '宁波港',
 'code': '601018',
 'general_capital': '1317284.78',
 'total_value': '4452422.56',
 'traded_market_value': '4452422.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '315764.44',
 'abbr': '圆通速递',
 'code': '600233',
 'general_capital': '316445.66',
 'total_value': '4439732.59',
 'traded_market_value': '4430175.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '7156.29',
 'abbr': '传音控股',
 'code': '688036',
 'general_capital': '80000.00',
 'total_value': '4393600.00',
 'traded_market_value': '393023.45'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '49456.28',
 'abbr': '中国软件',
 'code': '600536',
 'general_capital': '49456.28',
 'total_value': '4365505.68',
 'traded_market_value': '4365505.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '249071.73',
 'abbr': '中国长城',
 'code': '000066',
 'general_capital': '292818.21',
 'total_value': '4348350.35',
 'traded_market_value': '3698715.20'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '101277.38',
 'abbr': '上海临港',
 'code': '600848',
 'general_capital': '210206.82',
 'total_value': '4334464.65',
 'traded_market_value': '2088339.53'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '32064.00',
 'abbr': '通策医疗',
 'code': '600763',
 'general_capital': '32064.00',
 'total_value': '4331846.40',
 'traded_market_value': '4331846.40'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '195364.20',
 'abbr': '南极电商',
 'code': '002127',
 'general_capital': '245487.04',
 'total_value': '4276384.24',
 'traded_market_value': '3403244.36'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '168828.65',
 'abbr': '沪电股份',
 'code': '002463',
 'general_capital': '172471.74',
 'total_value': '4249703.58',
 'traded_market_value': '4159938.04'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:48:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:48:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '55484.29',
 'abbr': '招商公路',
 'code': '001965',
 'general_capital': '617822.15',
 'total_value': '4238259.96',
 'traded_market_value': '380622.22'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:13 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_9.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_8.html)
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '524792.49',
 'abbr': '金科股份',
 'code': '000656',
 'general_capital': '533971.58',
 'total_value': '4245074.07',
 'traded_market_value': '4172100.31'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '73375.88',
 'abbr': '高德红外',
 'code': '002414',
 'general_capital': '93638.40',
 'total_value': '4225901.20',
 'traded_market_value': '3311453.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '732881.35',
 'abbr': '上海石化',
 'code': '600688',
 'general_capital': '1082381.35',
 'total_value': '4221287.26',
 'traded_market_value': '2858237.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '266724.38',
 'abbr': '欧菲光',
 'code': '002456',
 'general_capital': '271286.71',
 'total_value': '4221221.25',
 'traded_market_value': '4150231.35'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '338760.29',
 'abbr': '金风科技',
 'code': '002202',
 'general_capital': '422506.76',
 'total_value': '4199717.24',
 'traded_market_value': '3367277.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '295987.95',
 'abbr': '兖州煤业',
 'code': '600188',
 'general_capital': '491201.60',
 'total_value': '4194861.66',
 'traded_market_value': '2527737.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '107867.15',
 'abbr': '华友钴业',
 'code': '603799',
 'general_capital': '114126.15',
 'total_value': '4183864.75',
 'traded_market_value': '3954409.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '37937.58',
 'abbr': '贝达药业',
 'code': '300558',
 'general_capital': '40100.00',
 'total_value': '4176816.00',
 'traded_market_value': '3951578.51'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '11033.41',
 'abbr': '大参林',
 'code': '603233',
 'general_capital': '54695.05',
 'total_value': '4165028.40',
 'traded_market_value': '840193.98'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '150206.02',
 'abbr': '光环新网',
 'code': '300383',
 'general_capital': '154313.99',
 'total_value': '4160305.23',
 'traded_market_value': '4049554.23'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '122266.67',
 'abbr': '东山精密',
 'code': '002384',
 'general_capital': '160657.25',
 'total_value': '4125678.12',
 'traded_market_value': '3139807.99'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '132787.10',
 'abbr': '卫宁健康',
 'code': '300253',
 'general_capital': '164132.37',
 'total_value': '4118081.28',
 'traded_market_value': '3331628.21'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '79663.72',
 'abbr': '中炬高新',
 'code': '600872',
 'general_capital': '79663.72',
 'total_value': '4102681.55',
 'traded_market_value': '4102681.55'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '81122.38',
 'abbr': '信维通信',
 'code': '300136',
 'general_capital': '96864.00',
 'total_value': '4087660.66',
 'traded_market_value': '3423364.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '865730.18',
 'abbr': '中远海控',
 'code': '601919',
 'general_capital': '1225952.92',
 'total_value': '4070163.70',
 'traded_market_value': '2874224.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '222637.25',
 'abbr': '正邦科技',
 'code': '002157',
 'general_capital': '250605.61',
 'total_value': '4049786.68',
 'traded_market_value': '3597817.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '529945.81',
 'abbr': '招商轮船',
 'code': '601872',
 'general_capital': '674012.01',
 'total_value': '4030591.83',
 'traded_market_value': '3169075.95'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '118248.91',
 'abbr': '中国卫星',
 'code': '600118',
 'general_capital': '118248.91',
 'total_value': '4026375.50',
 'traded_market_value': '4026375.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '24450.17',
 'abbr': '华大基因',
 'code': '300676',
 'general_capital': '40010.00',
 'total_value': '4010602.40',
 'traded_market_value': '2450884.83'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '110693.92',
 'abbr': '烽火通信',
 'code': '600498',
 'general_capital': '117098.46',
 'total_value': '4007109.42',
 'traded_market_value': '3787945.94'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '168950.78',
 'abbr': '北新建材',
 'code': '000786',
 'general_capital': '168950.78',
 'total_value': '3985549.00',
 'traded_market_value': '3985549.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '71163.01',
 'abbr': '启明星辰',
 'code': '002439',
 'general_capital': '93358.37',
 'total_value': '3967730.90',
 'traded_market_value': '3024427.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '669667.17',
 'abbr': '兴业证券',
 'code': '601377',
 'general_capital': '669667.17',
 'total_value': '3957732.96',
 'traded_market_value': '3957732.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '278357.62',
 'abbr': '大北农',
 'code': '002385',
 'general_capital': '419532.95',
 'total_value': '3952000.38',
 'traded_market_value': '2622128.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '104536.68',
 'abbr': '天坛生物',
 'code': '600161',
 'general_capital': '104536.68',
 'total_value': '3945214.33',
 'traded_market_value': '3945214.33'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '325333.19',
 'abbr': '浙江龙盛',
 'code': '600352',
 'general_capital': '325333.19',
 'total_value': '3933278.22',
 'traded_market_value': '3933278.22'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '383847.99',
 'abbr': '天风证券',
 'code': '601162',
 'general_capital': '666596.73',
 'total_value': '3926254.73',
 'traded_market_value': '2260864.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '106535.23',
 'abbr': '中航光电',
 'code': '002179',
 'general_capital': '110090.72',
 'total_value': '3914826.09',
 'traded_market_value': '3788392.87'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '5595.76',
 'abbr': '圣邦股份',
 'code': '300661',
 'general_capital': '10361.86',
 'total_value': '3875130.09',
 'traded_market_value': '2092700.75'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:14 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:14 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '999436.00',
 'abbr': '大唐发电',
 'code': '601991',
 'general_capital': '1850671.05',
 'total_value': '3867902.50',
 'traded_market_value': '2088821.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_10.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_9.html)
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '440214.05',
 'abbr': '川投能源',
 'code': '600674',
 'general_capital': '440214.05',
 'total_value': '3856275.06',
 'traded_market_value': '3856275.06'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '84789.33',
 'abbr': '先导智能',
 'code': '300450',
 'general_capital': '88144.63',
 'total_value': '3843987.18',
 'traded_market_value': '3697662.59'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '5595.76',
 'abbr': '圣邦股份',
 'code': '300661',
 'general_capital': '10361.86',
 'total_value': '3842490.21',
 'traded_market_value': '2075074.12'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '74176.70',
 'abbr': '顺鑫农业',
 'code': '000860',
 'general_capital': '74176.70',
 'total_value': '3826775.90',
 'traded_market_value': '3826775.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '273912.74',
 'abbr': '华天科技',
 'code': '002185',
 'general_capital': '274000.38',
 'total_value': '3819565.26',
 'traded_market_value': '3818343.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4009.85',
 'abbr': '大博医疗',
 'code': '002901',
 'general_capital': '40226.51',
 'total_value': '3798187.07',
 'traded_market_value': '378610.04'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '19353.01',
 'abbr': '璞泰来',
 'code': '603659',
 'general_capital': '43521.88',
 'total_value': '3792496.81',
 'traded_market_value': '1686421.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '280760.81',
 'abbr': '东华软件',
 'code': '002065',
 'general_capital': '311548.24',
 'total_value': '3791542.05',
 'traded_market_value': '3416859.11'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '75478.91',
 'abbr': '华林证券',
 'code': '002945',
 'general_capital': '270000.00',
 'total_value': '3780000.00',
 'traded_market_value': '1056704.72'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '125083.86',
 'abbr': '华海药业',
 'code': '600521',
 'general_capital': '132237.10',
 'total_value': '3776691.44',
 'traded_market_value': '3572395.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '306611.76',
 'abbr': '中天科技',
 'code': '600522',
 'general_capital': '306611.76',
 'total_value': '3768258.58',
 'traded_market_value': '3768258.58'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '166418.09',
 'abbr': '长城证券',
 'code': '002939',
 'general_capital': '310340.54',
 'total_value': '3761327.29',
 'traded_market_value': '2016987.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '59549.73',
 'abbr': '丽珠集团',
 'code': '000513',
 'general_capital': '93476.27',
 'total_value': '3754006.90',
 'traded_market_value': '2391517.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '135616.78',
 'abbr': '国网英大',
 'code': '600517',
 'general_capital': '531158.54',
 'total_value': '3749979.29',
 'traded_market_value': '957454.48'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '174978.43',
 'abbr': '华东医药',
 'code': '000963',
 'general_capital': '174980.95',
 'total_value': '3732343.77',
 'traded_market_value': '3732289.92'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60863.07',
 'abbr': '绝味食品',
 'code': '603517',
 'general_capital': '60863.07',
 'total_value': '3726037.11',
 'traded_market_value': '3726037.11'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1965039.78',
 'abbr': '国电电力',
 'code': '600795',
 'general_capital': '1965039.78',
 'total_value': '3694274.79',
 'traded_market_value': '3694274.79'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '165590.99',
 'abbr': '三环集团',
 'code': '300408',
 'general_capital': '174288.80',
 'total_value': '3675750.84',
 'traded_market_value': '3492313.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '186989.60',
 'abbr': '青岛港',
 'code': '601298',
 'general_capital': '649110.00',
 'total_value': '3641507.10',
 'traded_market_value': '1049011.66'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '257362.23',
 'abbr': '金发科技',
 'code': '600143',
 'general_capital': '257362.23',
 'total_value': '3628807.50',
 'traded_market_value': '3628807.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '699574.31',
 'abbr': '华电国际',
 'code': '600027',
 'general_capital': '986297.67',
 'total_value': '3609849.46',
 'traded_market_value': '2560441.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '98698.70',
 'abbr': '以岭药业',
 'code': '002603',
 'general_capital': '120371.75',
 'total_value': '3608744.95',
 'traded_market_value': '2958986.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '39578.82',
 'abbr': '美凯龙',
 'code': '601828',
 'general_capital': '355000.00',
 'total_value': '3550000.00',
 'traded_market_value': '395788.20'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '363306.60',
 'abbr': '北方稀土',
 'code': '600111',
 'general_capital': '363306.60',
 'total_value': '3545872.42',
 'traded_market_value': '3545872.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4100.00',
 'abbr': '丸美股份',
 'code': '603983',
 'general_capital': '40100.00',
 'total_value': '3529602.00',
 'traded_market_value': '360882.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '228811.95',
 'abbr': '联美控股',
 'code': '600167',
 'general_capital': '228811.95',
 'total_value': '3516839.63',
 'traded_market_value': '3516839.63'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '552946.72',
 'abbr': '长江证券',
 'code': '000783',
 'general_capital': '552956.86',
 'total_value': '3516805.62',
 'traded_market_value': '3516741.15'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '833415.83',
 'abbr': '金隅集团',
 'code': '601992',
 'general_capital': '1067777.11',
 'total_value': '3502308.93',
 'traded_market_value': '2733603.91'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '95340.12',
 'abbr': '千方科技',
 'code': '002373',
 'general_capital': '149101.98',
 'total_value': '3499423.41',
 'traded_market_value': '2237632.63'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:33 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:33 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4100.00',
 'abbr': '三只松鼠',
 'code': '300783',
 'general_capital': '40100.00',
 'total_value': '3490304.00',
 'traded_market_value': '356864.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:35 [scrapy.extensions.logstats] INFO: Crawled 10 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2020-05-20 10:49:51 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_11.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_10.html)
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '137147.03',
 'abbr': '同仁堂',
 'code': '600085',
 'general_capital': '137147.03',
 'total_value': '3475305.64',
 'traded_market_value': '3475305.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '144017.22',
 'abbr': '龙蟒佰利',
 'code': '002601',
 'general_capital': '203202.09',
 'total_value': '3468659.66',
 'traded_market_value': '2458373.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4100.00',
 'abbr': '丸美股份',
 'code': '603983',
 'general_capital': '40100.00',
 'total_value': '3464239.00',
 'traded_market_value': '354199.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '176120.12',
 'abbr': '万达电影',
 'code': '002739',
 'general_capital': '207842.83',
 'total_value': '3458504.67',
 'traded_market_value': '2930638.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1204266.10',
 'abbr': '石化油服',
 'code': '600871',
 'general_capital': '1898434.00',
 'total_value': '3455149.89',
 'traded_market_value': '2191764.30'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '146932.71',
 'abbr': '深科技',
 'code': '000021',
 'general_capital': '147125.94',
 'total_value': '3439804.39',
 'traded_market_value': '3435286.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '66685.52',
 'abbr': '招商积余',
 'code': '001914',
 'general_capital': '106034.61',
 'total_value': '3435521.23',
 'traded_market_value': '2160610.74'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '254455.40',
 'abbr': '恒逸石化',
 'code': '000703',
 'general_capital': '284172.55',
 'total_value': '3412912.29',
 'traded_market_value': '3056009.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '240669.26',
 'abbr': '财通证券',
 'code': '601108',
 'general_capital': '358900.00',
 'total_value': '3409550.00',
 'traded_market_value': '2286358.01'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '202437.99',
 'abbr': '巨人网络',
 'code': '002558',
 'general_capital': '202437.99',
 'total_value': '3400958.29',
 'traded_market_value': '3400958.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3800.62',
 'abbr': '虹软科技',
 'code': '688088',
 'general_capital': '40600.00',
 'total_value': '3400656.00',
 'traded_market_value': '318339.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '788237.78',
 'abbr': '桂冠电力',
 'code': '600236',
 'general_capital': '788237.78',
 'total_value': '3397304.83',
 'traded_market_value': '3397304.83'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '82408.09',
 'abbr': '安琪酵母',
 'code': '600298',
 'general_capital': '82408.09',
 'total_value': '3371315.14',
 'traded_market_value': '3371315.14'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '389356.79',
 'abbr': '荣盛发展',
 'code': '002146',
 'general_capital': '434816.39',
 'total_value': '3369826.98',
 'traded_market_value': '3017515.13'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '123742.29',
 'abbr': '银泰黄金',
 'code': '000975',
 'general_capital': '198337.30',
 'total_value': '3369750.81',
 'traded_market_value': '2102381.45'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '99356.71',
 'abbr': '大族激光',
 'code': '002008',
 'general_capital': '106707.01',
 'total_value': '3361270.81',
 'traded_market_value': '3129736.39'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '266728.29',
 'abbr': '越秀金控',
 'code': '000987',
 'general_capital': '275288.48',
 'total_value': '3336496.32',
 'traded_market_value': '3232746.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '278383.77',
 'abbr': '光线传媒',
 'code': '300251',
 'general_capital': '293360.84',
 'total_value': '3323778.35',
 'traded_market_value': '3154088.06'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '100682.70',
 'abbr': '纳思达',
 'code': '002180',
 'general_capital': '106335.00',
 'total_value': '3304891.80',
 'traded_market_value': '3129218.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '186174.36',
 'abbr': '亨通光电',
 'code': '600487',
 'general_capital': '195274.53',
 'total_value': '3304045.12',
 'traded_market_value': '3150070.20'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '120852.19',
 'abbr': '浙商证券',
 'code': '601878',
 'general_capital': '333334.70',
 'total_value': '3296680.22',
 'traded_market_value': '1195228.13'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4120.00',
 'abbr': '新产业',
 'code': '300832',
 'general_capital': '41160.00',
 'total_value': '3296092.80',
 'traded_market_value': '329929.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '501402.63',
 'abbr': '雅戈尔',
 'code': '600177',
 'general_capital': '501402.63',
 'total_value': '3289201.25',
 'traded_market_value': '3289201.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '350230.68',
 'abbr': '中国巨石',
 'code': '600176',
 'general_capital': '350230.68',
 'total_value': '3285163.82',
 'traded_market_value': '3285163.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '268190.13',
 'abbr': '安迪苏',
 'code': '600299',
 'general_capital': '268190.13',
 'total_value': '3274601.45',
 'traded_market_value': '3274601.45'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:52 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:52 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '48701.98',
 'abbr': '石基信息',
 'code': '002153',
 'general_capital': '106960.42',
 'total_value': '3261223.26',
 'traded_market_value': '1484923.25'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:52 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:52 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '273603.29',
 'abbr': '中远海能',
 'code': '600026',
 'general_capital': '476269.19',
 'total_value': '3252918.56',
 'traded_market_value': '1868710.44'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:52 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:52 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '65887.67',
 'abbr': '桃李面包',
 'code': '603866',
 'general_capital': '65887.67',
 'total_value': '3243649.76',
 'traded_market_value': '3243649.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:52 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:52 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '86685.56',
 'abbr': '鱼跃医疗',
 'code': '002223',
 'general_capital': '100247.69',
 'total_value': '3231985.62',
 'traded_market_value': '2794742.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:49:52 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:49:52 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '34677.54',
 'abbr': '浙江鼎力',
 'code': '603338',
 'general_capital': '34677.54',
 'total_value': '3231600.03',
 'traded_market_value': '3231600.03'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_12.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_11.html)
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '167345.53',
 'abbr': '九州通',
 'code': '600998',
 'general_capital': '187766.42',
 'total_value': '3223949.35',
 'traded_market_value': '2873322.78'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '34677.54',
 'abbr': '浙江鼎力',
 'code': '603338',
 'general_capital': '34677.54',
 'total_value': '3221196.76',
 'traded_market_value': '3221196.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '185280.91',
 'abbr': '航天信息',
 'code': '600271',
 'general_capital': '186252.91',
 'total_value': '3220312.79',
 'traded_market_value': '3203507.01'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '109606.19',
 'abbr': '圣农发展',
 'code': '002299',
 'general_capital': '124429.95',
 'total_value': '3210292.74',
 'traded_market_value': '2827839.77'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '27963.94',
 'abbr': '金域医学',
 'code': '603882',
 'general_capital': '45788.46',
 'total_value': '3173140.12',
 'traded_market_value': '1937900.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '62125.30',
 'abbr': '康弘药业',
 'code': '002773',
 'general_capital': '87559.77',
 'total_value': '3169663.62',
 'traded_market_value': '2248935.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '34875.37',
 'abbr': '天下秀',
 'code': '600556',
 'general_capital': '168042.03',
 'total_value': '3167592.29',
 'traded_market_value': '657400.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '360841.57',
 'abbr': '中航机电',
 'code': '002013',
 'general_capital': '360866.66',
 'total_value': '3164800.60',
 'traded_market_value': '3164580.59'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '91646.27',
 'abbr': '春秋航空',
 'code': '601021',
 'general_capital': '91672.77',
 'total_value': '3157210.24',
 'traded_market_value': '3156297.58'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '345113.72',
 'abbr': '中金黄金',
 'code': '600489',
 'general_capital': '345113.72',
 'total_value': '3154339.39',
 'traded_market_value': '3154339.39'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '120430.10',
 'abbr': '晶盛机电',
 'code': '300316',
 'general_capital': '128448.94',
 'total_value': '3153421.39',
 'traded_market_value': '2956558.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '220677.07',
 'abbr': '沙钢股份',
 'code': '002075',
 'general_capital': '220677.18',
 'total_value': '3144649.78',
 'traded_market_value': '3144648.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:02 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:02 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '6246.13',
 'abbr': '珀莱雅',
 'code': '603605',
 'general_capital': '20126.96',
 'total_value': '3144031.80',
 'traded_market_value': '975707.97'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '206932.05',
 'abbr': '白云机场',
 'code': '600004',
 'general_capital': '206932.05',
 'total_value': '3132951.26',
 'traded_market_value': '3132951.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '32259.81',
 'abbr': '光威复材',
 'code': '300699',
 'general_capital': '51835.00',
 'total_value': '3119430.30',
 'traded_market_value': '1941395.13'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '111497.85',
 'abbr': '南洋股份',
 'code': '002212',
 'general_capital': '115848.33',
 'total_value': '3103576.72',
 'traded_market_value': '2987027.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '341450.02',
 'abbr': '东方明珠',
 'code': '600637',
 'general_capital': '341450.02',
 'total_value': '3100366.18',
 'traded_market_value': '3100366.18'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '203398.85',
 'abbr': '通化东宝',
 'code': '600867',
 'general_capital': '203398.85',
 'total_value': '3095730.52',
 'traded_market_value': '3095730.52'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '512588.24',
 'abbr': '中国西电',
 'code': '601179',
 'general_capital': '512588.24',
 'total_value': '3085781.18',
 'traded_market_value': '3085781.18'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '59901.16',
 'abbr': '景旺电子',
 'code': '603228',
 'general_capital': '60873.44',
 'total_value': '3080804.85',
 'traded_market_value': '3031597.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '100931.03',
 'abbr': '国轩高科',
 'code': '002074',
 'general_capital': '112935.27',
 'total_value': '3069580.73',
 'traded_market_value': '2743305.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4100.00',
 'abbr': '良品铺子',
 'code': '603719',
 'general_capital': '40100.00',
 'total_value': '3062838.00',
 'traded_market_value': '313158.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '24108.49',
 'abbr': '万孚生物',
 'code': '300482',
 'general_capital': '34268.02',
 'total_value': '3061162.16',
 'traded_market_value': '2153611.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '27615.52',
 'abbr': '星宇股份',
 'code': '601799',
 'general_capital': '27615.52',
 'total_value': '3059799.97',
 'traded_market_value': '3059799.97'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '191007.91',
 'abbr': '四维图新',
 'code': '002405',
 'general_capital': '196156.32',
 'total_value': '3056115.42',
 'traded_market_value': '2975903.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '162032.98',
 'abbr': '华鲁恒升',
 'code': '600426',
 'general_capital': '162665.98',
 'total_value': '3051613.69',
 'traded_market_value': '3039738.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '128604.91',
 'abbr': '人福医药',
 'code': '600079',
 'general_capital': '135370.43',
 'total_value': '3047188.38',
 'traded_market_value': '2894896.44'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '32788.98',
 'abbr': '美亚光电',
 'code': '002690',
 'general_capital': '67600.00',
 'total_value': '3046732.00',
 'traded_market_value': '1477799.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '63944.53',
 'abbr': '养元饮品',
 'code': '603156',
 'general_capital': '105457.80',
 'total_value': '3042457.53',
 'traded_market_value': '1844799.76'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:03 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:03 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '302435.93',
 'abbr': '国金证券',
 'code': '600109',
 'general_capital': '302435.93',
 'total_value': '3039481.11',
 'traded_market_value': '3039481.11'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_13.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_12.html)
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '7186.46',
 'abbr': 'XD吉比特',
 'code': '603444',
 'general_capital': '7186.46',
 'total_value': '3031749.86',
 'traded_market_value': '3031749.86'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '239336.05',
 'abbr': '广电运通',
 'code': '002152',
 'general_capital': '240899.40',
 'total_value': '3023287.41',
 'traded_market_value': '3003667.41'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '160299.81',
 'abbr': '豫园股份',
 'code': '600655',
 'general_capital': '388376.20',
 'total_value': '3017683.05',
 'traded_market_value': '1245529.56'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '89268.66',
 'abbr': '汤臣倍健',
 'code': '300146',
 'general_capital': '158249.26',
 'total_value': '3009900.84',
 'traded_market_value': '1697889.98'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '45758.04',
 'abbr': '我武生物',
 'code': '300357',
 'general_capital': '52358.40',
 'total_value': '3005372.16',
 'traded_market_value': '2626511.29'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '177767.99',
 'abbr': '北大荒',
 'code': '600598',
 'general_capital': '177767.99',
 'total_value': '3000723.69',
 'traded_market_value': '3000723.69'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '388051.89',
 'abbr': '东吴证券',
 'code': '601555',
 'general_capital': '388051.89',
 'total_value': '2984119.04',
 'traded_market_value': '2984119.04'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4200.00',
 'abbr': '瑞芯微',
 'code': '603893',
 'general_capital': '41228.00',
 'total_value': '2979959.84',
 'traded_market_value': '303576.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '150408.40',
 'abbr': '华测检测',
 'code': '300012',
 'general_capital': '165753.07',
 'total_value': '2978582.69',
 'traded_market_value': '2702838.99'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '275796.07',
 'abbr': '东兴证券',
 'code': '601198',
 'general_capital': '275796.07',
 'total_value': '2953775.86',
 'traded_market_value': '2953775.86'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '212748.34',
 'abbr': '海格通信',
 'code': '002465',
 'general_capital': '230532.48',
 'total_value': '2948510.47',
 'traded_market_value': '2721051.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '96634.84',
 'abbr': '伟明环保',
 'code': '603568',
 'general_capital': '96658.33',
 'total_value': '2948079.20',
 'traded_market_value': '2947362.75'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '146159.92',
 'abbr': '申通快递',
 'code': '002468',
 'general_capital': '153080.22',
 'total_value': '2937609.36',
 'traded_market_value': '2804808.87'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '182892.05',
 'abbr': '深天马Ａ',
 'code': '000050',
 'general_capital': '204812.31',
 'total_value': '2928815.96',
 'traded_market_value': '2615356.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '93490.08',
 'abbr': '老板电器',
 'code': '002508',
 'general_capital': '94902.40',
 'total_value': '2922994.07',
 'traded_market_value': '2879494.41'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '374492.42',
 'abbr': '中南建设',
 'code': '000961',
 'general_capital': '375685.48',
 'total_value': '2922833.03',
 'traded_market_value': '2913551.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '17084.96',
 'abbr': '拉卡拉',
 'code': '300773',
 'general_capital': '40001.00',
 'total_value': '2921673.04',
 'traded_market_value': '1247885.31'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '103342.53',
 'abbr': '科伦药业',
 'code': '002422',
 'general_capital': '143978.61',
 'total_value': '2914126.99',
 'traded_market_value': '2091652.90'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '460477.74',
 'abbr': '葛洲坝',
 'code': '600068',
 'general_capital': '460477.74',
 'total_value': '2901009.77',
 'traded_market_value': '2901009.77'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '199690.04',
 'abbr': '东方电气',
 'code': '600875',
 'general_capital': '311879.21',
 'total_value': '2897357.89',
 'traded_market_value': '1855120.44'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '2000.00',
 'abbr': '壹网壹创',
 'code': '300792',
 'general_capital': '8013.90',
 'total_value': '2897024.85',
 'traded_market_value': '723000.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '112624.02',
 'abbr': '生物股份',
 'code': '600201',
 'general_capital': '112624.02',
 'total_value': '2889932.46',
 'traded_market_value': '2889932.46'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '218120.59',
 'abbr': '碧水源',
 'code': '300070',
 'general_capital': '316459.66',
 'total_value': '2857630.72',
 'traded_market_value': '1969628.95'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '493300.00',
 'abbr': '中国化学',
 'code': '601117',
 'general_capital': '493300.00',
 'total_value': '2851274.00',
 'traded_market_value': '2851274.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '350183.98',
 'abbr': '西部证券',
 'code': '002673',
 'general_capital': '350183.98',
 'total_value': '2850497.57',
 'traded_market_value': '2850497.57'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '124720.17',
 'abbr': '海普瑞',
 'code': '002399',
 'general_capital': '124720.17',
 'total_value': '2832395.07',
 'traded_market_value': '2832395.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '115350.43',
 'abbr': '通富微电',
 'code': '002156',
 'general_capital': '115370.46',
 'total_value': '2832344.72',
 'traded_market_value': '2831853.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '33333.33',
 'abbr': '苏州银行',
 'code': '002966',
 'general_capital': '333333.33',
 'total_value': '2826666.67',
 'traded_market_value': '282666.67'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '890439.77',
 'abbr': '上海建工',
 'code': '600170',
 'general_capital': '890439.77',
 'total_value': '2822694.08',
 'traded_market_value': '2822694.08'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:34 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:34 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '371431.28',
 'abbr': '特变电工',
 'code': '600089',
 'general_capital': '371431.28',
 'total_value': '2819163.41',
 'traded_market_value': '2819163.41'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:35 [scrapy.extensions.logstats] INFO: Crawled 13 pages (at 3 pages/min), scraped 0 items (at 0 items/min)
2020-05-20 10:50:41 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_14.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_13.html)
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '12521.48',
 'abbr': '天味食品',
 'code': '603317',
 'general_capital': '59907.48',
 'total_value': '2804268.90',
 'traded_market_value': '586130.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '189420.28',
 'abbr': '成都银行',
 'code': '601838',
 'general_capital': '361225.13',
 'total_value': '2795882.53',
 'traded_market_value': '1466112.94'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '481116.59',
 'abbr': '山东高速',
 'code': '600350',
 'general_capital': '481116.59',
 'total_value': '2795287.36',
 'traded_market_value': '2795287.36'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '50700.00',
 'abbr': '洽洽食品',
 'code': '002557',
 'general_capital': '50700.00',
 'total_value': '2787486.00',
 'traded_market_value': '2787486.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '97839.53',
 'abbr': '华润三九',
 'code': '000999',
 'general_capital': '97890.00',
 'total_value': '2783991.60',
 'traded_market_value': '2782556.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '77753.09',
 'abbr': '涪陵榨菜',
 'code': '002507',
 'general_capital': '78935.72',
 'total_value': '2783273.63',
 'traded_market_value': '2741573.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '578734.13',
 'abbr': '利欧股份',
 'code': '002131',
 'general_capital': '675480.42',
 'total_value': '2782979.33',
 'traded_market_value': '2384384.61'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '48397.12',
 'abbr': '重庆啤酒',
 'code': '600132',
 'general_capital': '48397.12',
 'total_value': '2775574.82',
 'traded_market_value': '2775574.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60000.00',
 'abbr': '口子窖',
 'code': '603589',
 'general_capital': '60000.00',
 'total_value': '2772600.00',
 'traded_market_value': '2772600.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '400461.12',
 'abbr': '阳 光 城',
 'code': '000671',
 'general_capital': '408279.64',
 'total_value': '2772218.73',
 'traded_market_value': '2719130.98'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '51368.80',
 'abbr': '易华录',
 'code': '300212',
 'general_capital': '54170.73',
 'total_value': '2770833.07',
 'traded_market_value': '2627514.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '86982.86',
 'abbr': '中国动力',
 'code': '600482',
 'general_capital': '169499.60',
 'total_value': '2762843.42',
 'traded_market_value': '1417820.57'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '221393.92',
 'abbr': 'XD宇通客',
 'code': '600066',
 'general_capital': '221393.92',
 'total_value': '2736428.88',
 'traded_market_value': '2736428.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '80193.64',
 'abbr': '锦江酒店',
 'code': '600754',
 'general_capital': '95793.64',
 'total_value': '2725329.17',
 'traded_market_value': '2281509.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '811030.18',
 'abbr': '广汇汽车',
 'code': '600297',
 'general_capital': '815802.98',
 'total_value': '2724781.97',
 'traded_market_value': '2708840.78'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3059.21',
 'abbr': '南微医学',
 'code': '688029',
 'general_capital': '13334.00',
 'total_value': '2720136.00',
 'traded_market_value': '624078.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '23006.66',
 'abbr': '安井食品',
 'code': '603345',
 'general_capital': '23637.66',
 'total_value': '2718095.09',
 'traded_market_value': '2645536.40'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '294612.96',
 'abbr': '国元证券',
 'code': '000728',
 'general_capital': '336544.70',
 'total_value': '2685626.74',
 'traded_market_value': '2351011.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '430312.92',
 'abbr': '天茂集团',
 'code': '000627',
 'general_capital': '494062.92',
 'total_value': '2682761.64',
 'traded_market_value': '2336599.14'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '177814.74',
 'abbr': '华西证券',
 'code': '002926',
 'general_capital': '262500.00',
 'total_value': '2682750.00',
 'traded_market_value': '1817266.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '12235.00',
 'abbr': '德赛西威',
 'code': '002920',
 'general_capital': '55000.00',
 'total_value': '2679600.00',
 'traded_market_value': '596089.20'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '81007.73',
 'abbr': '亿帆医药',
 'code': '002019',
 'general_capital': '123690.46',
 'total_value': '2671713.89',
 'traded_market_value': '1749767.07'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '442001.58',
 'abbr': '海澜之家',
 'code': '600398',
 'general_capital': '442001.58',
 'total_value': '2665269.53',
 'traded_market_value': '2665269.53'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '46485.83',
 'abbr': '招商港口',
 'code': '001872',
 'general_capital': '192236.51',
 'total_value': '2664398.06',
 'traded_market_value': '644293.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '134721.36',
 'abbr': '冀东水泥',
 'code': '000401',
 'general_capital': '134752.29',
 'total_value': '2658662.71',
 'traded_market_value': '2658052.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4000.00',
 'abbr': '斯达半导',
 'code': '603290',
 'general_capital': '16000.00',
 'total_value': '2651840.00',
 'traded_market_value': '662960.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '147709.94',
 'abbr': '天齐锂业',
 'code': '002466',
 'general_capital': '147709.94',
 'total_value': '2648439.19',
 'traded_market_value': '2648439.19'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '58484.21',
 'abbr': '顾家家居',
 'code': '603816',
 'general_capital': '60162.85',
 'total_value': '2642352.27',
 'traded_market_value': '2568626.31'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '99533.27',
 'abbr': '长沙银行',
 'code': '601577',
 'general_capital': '342155.38',
 'total_value': '2641439.50',
 'traded_market_value': '768396.86'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:41 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:41 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '377397.15',
 'abbr': '美锦能源',
 'code': '000723',
 'general_capital': '409926.31',
 'total_value': '2635826.14',
 'traded_market_value': '2426663.66'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_15.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_14.html)
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '36693.10',
 'abbr': '益丰药房',
 'code': '603939',
 'general_capital': '37892.25',
 'total_value': '2638816.33',
 'traded_market_value': '2555307.51'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '377397.15',
 'abbr': '美锦能源',
 'code': '000723',
 'general_capital': '409926.31',
 'total_value': '2635826.14',
 'traded_market_value': '2426663.66'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '200589.59',
 'abbr': '供销大集',
 'code': '000564',
 'general_capital': '600782.82',
 'total_value': '2631428.77',
 'traded_market_value': '878582.42'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '152970.98',
 'abbr': '辽宁成大',
 'code': '600739',
 'general_capital': '152970.98',
 'total_value': '2620392.91',
 'traded_market_value': '2620392.91'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '4240.00',
 'abbr': '中科软',
 'code': '603927',
 'general_capital': '42400.00',
 'total_value': '2620320.00',
 'traded_market_value': '262032.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '59496.77',
 'abbr': '山东药玻',
 'code': '600529',
 'general_capital': '59496.77',
 'total_value': '2620237.96',
 'traded_market_value': '2620237.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '337718.91',
 'abbr': '杭钢股份',
 'code': '600126',
 'general_capital': '337718.91',
 'total_value': '2617321.54',
 'traded_market_value': '2617321.54'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '30989.89',
 'abbr': '扬农化工',
 'code': '600486',
 'general_capital': '30989.89',
 'total_value': '2615546.78',
 'traded_market_value': '2615546.78'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '114158.06',
 'abbr': '步长制药',
 'code': '603858',
 'general_capital': '114158.06',
 'total_value': '2606228.53',
 'traded_market_value': '2606228.53'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '210619.02',
 'abbr': '太极实业',
 'code': '600667',
 'general_capital': '210619.02',
 'total_value': '2599038.68',
 'traded_market_value': '2599038.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '455203.83',
 'abbr': '申能股份',
 'code': '600642',
 'general_capital': '491203.83',
 'total_value': '2598468.27',
 'traded_market_value': '2408028.27'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '58947.67',
 'abbr': '中直股份',
 'code': '600038',
 'general_capital': '58947.67',
 'total_value': '2598413.36',
 'traded_market_value': '2598413.36'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '362100.00',
 'abbr': '华安证券',
 'code': '600909',
 'general_capital': '362100.00',
 'total_value': '2596257.00',
 'traded_market_value': '2596257.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '152376.22',
 'abbr': '中集集团',
 'code': '000039',
 'general_capital': '358450.44',
 'total_value': '2595181.17',
 'traded_market_value': '1103203.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '859817.19',
 'abbr': '新湖中宝',
 'code': '600208',
 'general_capital': '859934.35',
 'total_value': '2588402.40',
 'traded_market_value': '2588049.75'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '67431.87',
 'abbr': '杰瑞股份',
 'code': '002353',
 'general_capital': '95785.40',
 'total_value': '2581416.51',
 'traded_market_value': '1817288.88'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '24092.15',
 'abbr': '健帆生物',
 'code': '300529',
 'general_capital': '41866.34',
 'total_value': '2576872.98',
 'traded_market_value': '1482871.72'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '123726.31',
 'abbr': '均胜电子',
 'code': '600699',
 'general_capital': '123726.31',
 'total_value': '2573507.18',
 'traded_market_value': '2573507.18'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '89425.00',
 'abbr': '昆仑万维',
 'code': '300418',
 'general_capital': '114836.93',
 'total_value': '2573495.50',
 'traded_market_value': '2004014.30'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '15544.81',
 'abbr': '坚朗五金',
 'code': '002791',
 'general_capital': '32154.00',
 'total_value': '2565889.20',
 'traded_market_value': '1240475.93'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '564510.91',
 'abbr': '西南证券',
 'code': '600369',
 'general_capital': '564510.91',
 'total_value': '2551589.32',
 'traded_market_value': '2551589.32'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '480000.00',
 'abbr': '重庆水务',
 'code': '601158',
 'general_capital': '480000.00',
 'total_value': '2544000.00',
 'traded_market_value': '2544000.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '67124.85',
 'abbr': '上海家化',
 'code': '600315',
 'general_capital': '67124.85',
 'total_value': '2541346.67',
 'traded_market_value': '2541346.67'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '3732.55',
 'abbr': '晶晨股份',
 'code': '688099',
 'general_capital': '41112.00',
 'total_value': '2536610.40',
 'traded_market_value': '230298.34'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '82143.52',
 'abbr': '中船防务',
 'code': '600685',
 'general_capital': '141350.64',
 'total_value': '2533003.43',
 'traded_market_value': '1472011.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '120540.51',
 'abbr': '航天发展',
 'code': '000547',
 'general_capital': '160567.89',
 'total_value': '2532155.60',
 'traded_market_value': '1900923.78'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '79611.53',
 'abbr': '新宝股份',
 'code': '002705',
 'general_capital': '80147.29',
 'total_value': '2531051.37',
 'traded_market_value': '2514132.09'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '126512.64',
 'abbr': '中顺洁柔',
 'code': '002511',
 'general_capital': '130889.13',
 'total_value': '2530086.83',
 'traded_market_value': '2445489.37'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '117910.82',
 'abbr': '万达信息',
 'code': '300168',
 'general_capital': '118758.48',
 'total_value': '2529555.54',
 'traded_market_value': '2511500.38'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:51 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:50:51 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '76321.10',
 'abbr': '九阳股份',
 'code': '002242',
 'general_capital': '76731.20',
 'total_value': '2525991.10',
 'traded_market_value': '2512490.68'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:50:54 [scrapy.crawler] INFO: Received SIGTERM, shutting down gracefully. Send again to force 
2020-05-20 10:50:54 [scrapy.core.engine] INFO: Closing spider (shutdown)
2020-05-20 10:51:23 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://quote.stockstar.com/stock/ranklist_a_3_1_16.html> (referer: http://quote.stockstar.com/stock/ranklist_a_3_1_15.html)
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '194692.05',
 'abbr': '健康元',
 'code': '600380',
 'general_capital': '194692.05',
 'total_value': '2517368.24',
 'traded_market_value': '2517368.24'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '74476.16',
 'abbr': '宏发股份',
 'code': '600885',
 'general_capital': '74476.16',
 'total_value': '2516549.28',
 'traded_market_value': '2516549.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '843801.74',
 'abbr': '君正集团',
 'code': '601216',
 'general_capital': '843801.74',
 'total_value': '2506091.16',
 'traded_market_value': '2506091.16'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '224047.13',
 'abbr': '中华企业',
 'code': '600675',
 'general_capital': '609613.53',
 'total_value': '2505511.59',
 'traded_market_value': '920833.70'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '104843.14',
 'abbr': '拓普集团',
 'code': '601689',
 'general_capital': '105498.77',
 'total_value': '2500320.97',
 'traded_market_value': '2484782.40'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '110569.11',
 'abbr': '人民网',
 'code': '603000',
 'general_capital': '110569.11',
 'total_value': '2492227.64',
 'traded_market_value': '2492227.64'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '306983.96',
 'abbr': '贵阳银行',
 'code': '601997',
 'general_capital': '321802.87',
 'total_value': '2481100.10',
 'traded_market_value': '2366846.37'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '139304.91',
 'abbr': '中航高科',
 'code': '600862',
 'general_capital': '139304.91',
 'total_value': '2475448.26',
 'traded_market_value': '2475448.26'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '186700.00',
 'abbr': '中国电影',
 'code': '600977',
 'general_capital': '186700.00',
 'total_value': '2473775.00',
 'traded_market_value': '2473775.00'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '1643600.27',
 'abbr': '海航控股',
 'code': '600221',
 'general_capital': '1680612.03',
 'total_value': '2470499.69',
 'traded_market_value': '2416092.40'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '350240.00',
 'abbr': '第一创业',
 'code': '002797',
 'general_capital': '350240.00',
 'total_value': '2465689.60',
 'traded_market_value': '2465689.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '978733.95',
 'abbr': '南山铝业',
 'code': '600219',
 'general_capital': '1195048.15',
 'total_value': '2461799.19',
 'traded_market_value': '2016191.94'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '48830.35',
 'abbr': '水井坊',
 'code': '600779',
 'general_capital': '48854.57',
 'total_value': '2453476.50',
 'traded_market_value': '2452260.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '34098.00',
 'abbr': '福莱特',
 'code': '601865',
 'general_capital': '195000.00',
 'total_value': '2453100.00',
 'traded_market_value': '428952.84'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '175952.57',
 'abbr': '中航电子',
 'code': '600372',
 'general_capital': '175952.57',
 'total_value': '2447500.28',
 'traded_market_value': '2447500.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '28319.13',
 'abbr': '中科创达',
 'code': '300496',
 'general_capital': '40251.51',
 'total_value': '2443266.64',
 'traded_market_value': '1718971.17'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '155609.92',
 'abbr': '华峰氨纶',
 'code': '002064',
 'general_capital': '463351.92',
 'total_value': '2441864.63',
 'traded_market_value': '820064.28'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '60714.64',
 'abbr': '宏大爆破',
 'code': '002683',
 'general_capital': '70705.64',
 'total_value': '2441465.67',
 'traded_market_value': '2096476.50'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '34886.28',
 'abbr': '百润股份',
 'code': '002568',
 'general_capital': '51980.26',
 'total_value': '2433716.01',
 'traded_market_value': '1633375.78'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '135163.72',
 'abbr': '中国外运',
 'code': '601598',
 'general_capital': '740080.39',
 'total_value': '2427463.67',
 'traded_market_value': '443337.01'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '138585.70',
 'abbr': '欣旺达',
 'code': '300207',
 'general_capital': '156913.53',
 'total_value': '2427452.36',
 'traded_market_value': '2143920.81'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '16592.54',
 'abbr': '盈趣科技',
 'code': '002925',
 'general_capital': '45812.84',
 'total_value': '2419376.08',
 'traded_market_value': '876251.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '799370.27',
 'abbr': '鞍钢股份',
 'code': '000898',
 'general_capital': '940525.02',
 'total_value': '2417149.30',
 'traded_market_value': '2054381.60'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '283520.05',
 'abbr': '建发股份',
 'code': '600153',
 'general_capital': '283520.05',
 'total_value': '2415590.85',
 'traded_market_value': '2415590.85'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '5344.09',
 'abbr': '诚迈科技',
 'code': '300598',
 'general_capital': '8000.00',
 'total_value': '2407280.00',
 'traded_market_value': '1608090.72'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '47419.14',
 'abbr': '海思科',
 'code': '002653',
 'general_capital': '107364.16',
 'total_value': '2386705.32',
 'traded_market_value': '1054127.53'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '422173.04',
 'abbr': '华菱钢铁',
 'code': '000932',
 'general_capital': '612907.72',
 'total_value': '2384211.04',
 'traded_market_value': '1642253.11'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '31710.96',
 'abbr': '老凤祥',
 'code': '600612',
 'general_capital': '52311.78',
 'total_value': '2380185.83',
 'traded_market_value': '1442848.82'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '36643.68',
 'abbr': '七一二',
 'code': '603712',
 'general_capital': '77200.00',
 'total_value': '2375444.00',
 'traded_market_value': '1127526.03'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [peewee] DEBUG: ('SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE() AND table_type != %s ORDER BY table_name', ('VIEW',))
2020-05-20 10:51:23 [scrapy.core.scraper] ERROR: Error processing {'Flow_of_equity': '269218.96',
 'abbr': '青农商行',
 'code': '002958',
 'general_capital': '555555.56',
 'total_value': '2372222.22',
 'traded_market_value': '1149564.96'}
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/twisted/internet/defer.py", line 654, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/scrapy/utils/defer.py", line 154, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/Users/zhaojining/python_Project/ScrapyProject/mySpider/mySpider/pipelines.py", line 13, in process_item
    if Stockstar.table_exists() == False:
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 6581, in table_exists
    return cls._schema.database.table_exists(M.table.__name__, M.schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3264, in table_exists
    return table_name in self.get_tables(schema=schema)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3962, in get_tables
    return [table for table, in self.execute_sql(query, ('VIEW',))]
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3097, in execute_sql
    cursor = self.cursor(commit)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3081, in cursor
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3035, in connect
    self._state.set_connection(self._connect())
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/peewee.py", line 3933, in _connect
    conn = mysql.connect(db=self.database, **self.connect_params)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/pymysql/connections.py", line 589, in connect
    self.host_info = "socket %s:%d" % (self.host, self.port)
TypeError: %d format: a number is required, not str
2020-05-20 10:51:23 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 1,
 'downloader/exception_type_count/twisted.web._newclient.ResponseNeverReceived': 1,
 'downloader/request_bytes': 6067,
 'downloader/request_count': 17,
 'downloader/request_method_count/GET': 17,
 'downloader/response_bytes': 159587,
 'downloader/response_count': 16,
 'downloader/response_status_count/200': 16,
 'elapsed_time_seconds': 287.909715,
 'finish_reason': 'shutdown',
 'finish_time': datetime.datetime(2020, 5, 20, 2, 51, 23, 489643),
 'log_count/DEBUG': 497,
 'log_count/ERROR': 480,
 'log_count/INFO': 15,
 'memusage/max': 64512000,
 'memusage/startup': 55812096,
 'request_depth_max': 16,
 'response_received_count': 16,
 'retry/count': 1,
 'retry/reason_count/twisted.web._newclient.ResponseNeverReceived': 1,
 'scheduler/dequeued': 17,
 'scheduler/dequeued/memory': 17,
 'scheduler/enqueued': 18,
 'scheduler/enqueued/memory': 18,
 'start_time': datetime.datetime(2020, 5, 20, 2, 46, 35, 579928)}
2020-05-20 10:51:23 [scrapy.core.engine] INFO: Spider closed (shutdown)
